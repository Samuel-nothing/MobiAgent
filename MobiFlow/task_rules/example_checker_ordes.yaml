task_id: example_order_demo
app_id: com.example.app
task_type: demo
description: æ¼”ç¤ºå¤šè·¯å¾„ä»»åŠ¡éªŒè¯é…ç½®çš„å®Œæ•´ç¤ºä¾‹ï¼Œå±•ç¤ºdepså’Œnextçš„ä½¿ç”¨

####
# é…ç½®è¯´æ˜ï¼š
# deps: ANDè¯­ä¹‰ - ä¸¥æ ¼çš„å‰ç½®ä¾èµ–ï¼Œæ‰€æœ‰listedèŠ‚ç‚¹å¿…é¡»å…ˆå®Œæˆ
# next: ORè¯­ä¹‰ - çµæ´»çš„åç»§é€‰æ‹©ï¼Œå¯ä»¥è¿›å…¥ä»»ä¸€listedèŠ‚ç‚¹
# æœ¬ç¤ºä¾‹å±•ç¤ºä¸€ä¸ªç”µå•†è´­ç‰©ä»»åŠ¡çš„å¤šç§è·¯å¾„é…ç½®
####

nodes:
  # ç¬¬1æ­¥ï¼šå¯åŠ¨åº”ç”¨ï¼ˆå…¥å£èŠ‚ç‚¹ï¼‰
  - id: launch_app
    name: å¯åŠ¨è´­ç‰©åº”ç”¨
    condition:
      type: escalate
      params:
        ocr:
          any: ["æ‰“å¼€åº”ç”¨", "å¯åŠ¨", "è¿›å…¥é¦–é¡µ", "ä¸»é¡µé¢"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦æˆåŠŸå¯åŠ¨äº†è´­ç‰©åº”ç”¨ï¼Ÿ"
          expected_true: true
    next: [search_entry, browse_category]  # ORè¯­ä¹‰ï¼šå¯ä»¥é€‰æ‹©æœç´¢æˆ–æµè§ˆåˆ†ç±»

  # è·¯å¾„Aï¼šæœç´¢å…¥å£åˆ†æ”¯
  - id: search_entry
    name: è¿›å…¥æœç´¢åŠŸèƒ½
    condition:
      type: escalate
      params:
        ocr:
          any: ["æœç´¢", "search", "ğŸ”"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦ç‚¹å‡»äº†æœç´¢åŠŸèƒ½ï¼Ÿ"
          expected_true: true
    next: [input_search_keyword]

  # è·¯å¾„Bï¼šåˆ†ç±»æµè§ˆåˆ†æ”¯
  - id: browse_category
    name: æµè§ˆå•†å“åˆ†ç±»
    condition:
      type: escalate
      params:
        ocr:
          any: ["åˆ†ç±»", "ç±»ç›®", "å•†å“åˆ†ç±»", "category"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦è¿›å…¥äº†å•†å“åˆ†ç±»é¡µé¢ï¼Ÿ"
          expected_true: true
    next: [select_category]

  # æœç´¢è·¯å¾„ç»§ç»­
  - id: input_search_keyword
    name: è¾“å…¥æœç´¢å…³é”®è¯
    condition:
      type: escalate
      params:
        ocr:
          any: ["è¾“å…¥", "æœç´¢æ¡†", "å…³é”®è¯"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦è¾“å…¥äº†ä»»åŠ¡task_descriptionæ‰€éœ€ç‰©å“çš„æœç´¢å…³é”®è¯ï¼Ÿ"
          expected_true: true
    next: [search_results]

  # åˆ†ç±»è·¯å¾„ç»§ç»­
  - id: select_category
    name: é€‰æ‹©å•†å“åˆ†ç±»
    condition:
      type: escalate
      params:
        ocr:
          any: ["é€‰æ‹©", "ç‚¹å‡»", "åˆ†ç±»"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦æ­£ç¡®é€‰æ‹©äº†å•†å“åˆ†ç±»ï¼Ÿ"
          expected_true: true
    next: [category_results]

  # æœç´¢ç»“æœé¡µé¢
  - id: search_results
    name: æŸ¥çœ‹æœç´¢ç»“æœ
    condition:
      type: escalate
      params:
        ocr:
          any: ["æœç´¢ç»“æœ", "å…±", "ä»¶å•†å“", "ç»“æœ"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦æ˜¾ç¤ºäº†æœç´¢ç»“æœï¼Ÿ"
          expected_true: true
    next: [apply_filter, select_product]  # ORè¯­ä¹‰ï¼šå¯ä»¥ç­›é€‰æˆ–ç›´æ¥é€‰æ‹©å•†å“

  # åˆ†ç±»ç»“æœé¡µé¢
  - id: category_results
    name: æŸ¥çœ‹åˆ†ç±»å•†å“åˆ—è¡¨
    condition:
      type: escalate
      params:
        ocr:
          any: ["å•†å“åˆ—è¡¨", "åˆ†ç±»å•†å“", "å•†å“"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦æ˜¾ç¤ºäº†åˆ†ç±»å•†å“åˆ—è¡¨ï¼Ÿ"
          expected_true: true
    next: [apply_filter, select_product]  # ORè¯­ä¹‰ï¼šåŒæ ·å¯ä»¥ç­›é€‰æˆ–ç›´æ¥é€‰æ‹©

  # å¯é€‰æ­¥éª¤ï¼šåº”ç”¨ç­›é€‰æ¡ä»¶
  - id: apply_filter
    name: åº”ç”¨ç­›é€‰æ¡ä»¶
    condition:
      type: escalate
      params:
        ocr:
          any: ["ç­›é€‰", "æ’åº", "é”€é‡", "ä»·æ ¼", "è¯„åˆ†", "filter"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦æŒ‰ç…§ä»»åŠ¡task_descriptionè¦æ±‚æ‰§è¡Œäº†ç›¸åº”çš„ç­›é€‰æˆ–æ’åºæ“ä½œï¼Ÿ"
          expected_true: true
    next: [select_product]

  # é€‰æ‹©å•†å“ï¼ˆä¸¤æ¡è·¯å¾„æ±‡èšç‚¹ï¼‰
  - id: select_product
    name: é€‰æ‹©ç›®æ ‡å•†å“
    condition:
      type: escalate
      params:
        ocr:
          any: ["é€‰æ‹©", "ç‚¹å‡»", "å•†å“", "è¯¦æƒ…"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦é€‰æ‹©äº†ç›®æ ‡å•†å“ï¼Ÿ"
          expected_true: true
    next: [add_to_cart, buy_now]  # ORè¯­ä¹‰ï¼šå¯ä»¥åŠ è´­ç‰©è½¦æˆ–ç›´æ¥è´­ä¹°

  # è·¯å¾„Cï¼šåŠ å…¥è´­ç‰©è½¦åˆ†æ”¯
  - id: add_to_cart
    name: åŠ å…¥è´­ç‰©è½¦
    condition:
      type: juxtaposition
      params:
        ocr:
          any: ["åŠ å…¥è´­ç‰©è½¦", "è´­ç‰©è½¦", "cart"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦å°†ä»»åŠ¡task_descriptionæ‰€è¦æ±‚å•†å“åŠ å…¥äº†è´­ç‰©è½¦ï¼Ÿ"
          expected_true: true
    next: [go_to_cart]

  # è·¯å¾„Dï¼šç«‹å³è´­ä¹°åˆ†æ”¯
  - id: buy_now
    name: ç«‹å³è´­ä¹°
    condition:
      type: juxtaposition
      params:
        ocr:
          any: ["ç«‹å³è´­ä¹°", "é©¬ä¸Šä¹°", "buy now"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦ç‚¹å‡»äº†ç«‹å³è´­ä¹°ï¼Ÿ"
          expected_true: true
    next: [checkout]

  # è´­ç‰©è½¦è·¯å¾„ç»§ç»­
  - id: go_to_cart
    name: è¿›å…¥è´­ç‰©è½¦
    condition:
      type: escalate
      params:
        ocr:
          any: ["è´­ç‰©è½¦", "cart", "å·²åŠ å…¥"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦è¿›å…¥äº†è´­ç‰©è½¦é¡µé¢ï¼Ÿ"
          expected_true: true
    next: [checkout]

  # æœ€ç»ˆç»“ç®—ï¼ˆä¸¤æ¡è·¯å¾„æœ€ç»ˆæ±‡èšï¼‰
  - id: checkout
    name: ç»“ç®—/æ”¯ä»˜
    deps: []  # æ— å¼ºåˆ¶ä¾èµ–ï¼Œé€šè¿‡nextè·¯å¾„åˆ°è¾¾å³å¯
    condition:
      type: escalate
      params:
        ocr:
          any: ["ç»“ç®—", "æ”¯ä»˜", "ç¡®è®¤è®¢å•", "checkout", "pay"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦å®Œæˆäº†ç»“ç®—æˆ–æ”¯ä»˜æ“ä½œï¼Ÿ"
          expected_true: true

  # å¯é€‰ï¼šè®¢å•ç¡®è®¤
  - id: order_confirmation
    deps: [checkout]  # ANDè¯­ä¹‰ï¼šå¿…é¡»ç­‰å¾…checkoutå®Œæˆ
    name: è®¢å•ç¡®è®¤
    condition:
      type: escalate
      params:
        ocr:
          any: ["è®¢å•æˆåŠŸ", "æ”¯ä»˜æˆåŠŸ", "ä¸‹å•æˆåŠŸ", "ç¡®è®¤"]
        llm:
          prompt: "è¯¥æ­¥æ˜¯å¦æ˜¾ç¤ºäº†è®¢å•ç¡®è®¤ä¿¡æ¯ï¼Ÿ"
          expected_true: true

success:
  any_of: [checkout, order_confirmation]  # å®Œæˆç»“ç®—æˆ–çœ‹åˆ°è®¢å•ç¡®è®¤å³ä¸ºæˆåŠŸ
